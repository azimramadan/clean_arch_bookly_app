# üìö Bookly App ‚Äî Clean Architecture in Flutter

<div align="center">

![Flutter](https://img.shields.io/badge/Flutter-02569B?style=for-the-badge&logo=flutter&logoColor=white)
![Dart](https://img.shields.io/badge/Dart-0175C2?style=for-the-badge&logo=dart&logoColor=white)
![Clean Architecture](https://img.shields.io/badge/Clean%20Architecture-6DB33F?style=for-the-badge)
![BLoC](https://img.shields.io/badge/BLoC-00D9FF?style=for-the-badge)

**A Flutter project built with Clean Architecture principles to demonstrate professional app structure, scalability, and maintainability.**


</div>

---

## üéØ Project Overview

**Bookly** is a Flutter application that displays books using real API data from Google Books API. 

**The primary purpose of this project is to practice and demonstrate Clean Architecture implementation in Flutter** ‚Äî not to build a production-ready book app, but to **showcase best practices** in:

- ‚úÖ Separating concerns into **Data**, **Domain**, and **Presentation** layers
- ‚úÖ Enforcing **Dependency Inversion Principle**
- ‚úÖ Promoting **testability** and **scalability**
- ‚úÖ Writing **maintainable** and **modular** code

This project serves as a **learning resource** and **portfolio piece** for developers who want to understand how to structure Flutter apps professionally using Clean Architecture.

---

## üß∞ **Tech Stack**

> The project is built using a modern Flutter ecosystem to ensure scalability, maintainability, and adherence to Clean Architecture principles.

- **Flutter** ‚Äî Cross-platform UI framework for building native apps  
- **Dart** ‚Äî Core programming language used for Flutter development  
- **Bloc / Cubit** ‚Äî Reactive and predictable state management  
- **Dio** ‚Äî HTTP client for handling API requests  
- **Hive** ‚Äî Local database for caching and persistence  
- **GetIt** ‚Äî Dependency injection using the service locator pattern  
- **GoRouter** ‚Äî Declarative navigation and routing solution  
- **Dartz** ‚Äî Functional programming utilities (Either, Failure handling)  
- **Equatable** ‚Äî Simplifies value equality for cleaner state comparison  
- **flutter_dotenv** ‚Äî Environment variables management  



---

## üèóÔ∏è Clean Architecture Breakdown

This project follows **Uncle Bob's Clean Architecture** principles, organizing the codebase into **three independent layers**:


![Clean Architecture Diagram](clean-architecture-uncle-bo.jpg)


### üìê The Dependency Rule

> **Dependencies always point inward** ‚Äî from outer layers (Presentation/Data) toward the core (Domain).

The **Domain layer** is the heart of the application:
- ‚ùå **Does NOT** depend on Flutter or any external framework
- ‚úÖ Contains **pure business logic**
- ‚úÖ Defines **abstract contracts** (Repositories)
- ‚úÖ Holds **Use Cases** (application-specific operations)

---

### 1Ô∏è‚É£ Domain Layer ‚Äî The Core üß†

**Location:** `lib/features/books/domain/`

The domain layer is the **most important** layer. It contains:

#### üì¶ Entities
Pure Dart objects representing business concepts:

```dart
class BookEntity {
  final String id;
  final String title;
  final String author;
  final num price;
  final num rating;
  final String imageUrl;

  BookEntity({
    required this.id,
    required this.title,
    required this.author,
    required this.imageUrl,
    required this.price,
    required this.rating,
  });
}
```

#### üìã Repository Interfaces
Abstract contracts that define **what** operations are needed (not **how**):

```dart
abstract class BooksRepository {
  Future<Either<Failure, List<BookEntity>>> getNewestBooks({int pageNumber = 0});
}
```

#### üéØ Use Cases
Single-responsibility classes that execute specific business operations:

```dart
class GetFeaturedBooksUseCase extends UseCase<List<BookEntity>, int> {
  final BooksRepository repository;

  GetFeaturedBooksUseCase({required this.repository});

  @override
  Future<Either<Failure, List<BookEntity>>> call(int pageNumber) async {
    // üí° Note:
    // A UseCase is not always just a direct call to the repository.
    // It can contain business logic that belongs to the "Domain" layer.
    //
    // Example:
    // You might want to check if the user is connected to the internet
    // before calling the repository, to avoid unnecessary API calls.
    //
    // if (!await NetworkInfo.isConnected()) {
    //   return Left(NoInternetConnectionFailure());
    // }

    return await repository.getNewestBooks(pageNumber: pageNumber);
  }
}

```

**Why Use Cases?**
- ‚úÖ Encapsulate business logic
- ‚úÖ Reusable across different features
- ‚úÖ Easy to test independently
- ‚úÖ Follow Single Responsibility Principle

---

### 2Ô∏è‚É£ Data Layer ‚Äî Implementation Details üîå

**Location:** `lib/features/books/data/`

This layer **implements** the repositories defined in the domain layer and handles:

#### üåê Remote Data Source
Fetches data from Google Books API using **Dio**:

```dart
class BooksRemoteDataSourceImpl implements BooksRemoteDataSource {
  final ApiService apiService;
  const BooksRemoteDataSourceImpl({required this.apiService});

  @override
  Future<List<BookModel>> getNewestBooks({int pageNumber = 0}) async {
    return getBooks(orderBy: ApiConstants.orderNewest, pageNumber: pageNumber);
  }

  Future<List<BookModel>> getBooks({required String orderBy, int pageNumber = 0}) async {
    final startIndex = pageNumber * 10;
    final response = await apiService.getVolumes(
      query: 'programming',
      filter: ApiConstants.filterFreeEbooks,
      maxResults: ApiConstants.defaultMaxResults,
      orderBy: orderBy,
      startIndex: startIndex,
    );
    return processResponse(response);
  }

  List<BookModel> processResponse(Response response) {
    if (response.statusCode == 200) {
      final data = response.data as Map<String, dynamic>;
      final items = data['items'] as List<dynamic>?;
      if (items == null || items.isEmpty) return [];
      return items.map((json) => BookModel.fromJson(json as Map<String, dynamic>)).toList();
    } else {
      throw ServerException(
        statusCode: response.statusCode ?? 0,
        responseData: response.data,
      );
    }
  }
}

```

#### üíæ Local Data Source
Caches data locally using **Hive**:

```dart
class BooksLocalDataSourceImpl implements BooksLocalDataSource {
  const BooksLocalDataSourceImpl();

  @override
  Future<void> cacheNewestBooks(List<BookModel> books) async {
    final box = HiveHelper.newestBooksBox;
    for (final book in books) {
      if (book.bookId.isEmpty) continue;
      await box.put(book.bookId, book);
    }
  }

  @override
  Future<List<BookModel>> getCachedNewestBooks({int pageNumber = 0}) async {
    final box = HiveHelper.newestBooksBox;
    if (box.isEmpty) return const [];

    final startIndex = pageNumber * 10;
    final endIndex = startIndex + 10;
    final cachedBooks = box.values.toList();

    if (startIndex >= cachedBooks.length) return const [];
    return cachedBooks.sublist(
      startIndex,
      endIndex > cachedBooks.length ? cachedBooks.length : endIndex,
    );
  }
}

```

#### üèõÔ∏è Repository Implementation
Combines remote and local data sources, handles errors, and converts models to entities:

```dart
class BooksRepositoryImpl implements BooksRepository {
  final BooksRemoteDataSource remoteDataSource;
  final BooksLocalDataSource localDataSource;

  BooksRepositoryImpl({
    required this.remoteDataSource,
    required this.localDataSource,
  });

  @override
  Future<Either<Failure, List<BookEntity>>> getNewestBooks({int pageNumber = 0}) async {
    final cachedResult = await getNewestBooksFromCache(pageNumber: pageNumber);

    return cachedResult.fold(
      (failure) async {
        try {
          final remoteBooks = await remoteDataSource.getNewestBooks(pageNumber: pageNumber);
          await localDataSource.cacheNewestBooks(remoteBooks);
          return Right(remoteBooks.cast<BookEntity>());
        } on DioException catch (e) {
          return left(ServerFailure.fromDioError(e));
        } on ServerException catch (e) {
          return left(ServerFailure.fromResponse(
            response: e.responseData,
            statusCode: e.statusCode,
          ));
        } catch (e) {
          return left(ServerFailure(message: e.toString()));
        }
      },
      (cachedBooks) => Right(cachedBooks),
    );
  }

  Future<Either<Failure, List<BookEntity>>> getNewestBooksFromCache({int pageNumber = 0}) async {
    try {
      final cachedBooks = await localDataSource.getCachedNewestBooks(pageNumber: pageNumber);
      if (cachedBooks.isEmpty) {
        return const Left(CacheFailure(message: 'No cached data available.'));
      }
      return Right(cachedBooks.cast<BookEntity>());
    } catch (e) {
      return Left(CacheFailure(message: e.toString()));
    }
  }
}

```

**Key Points:**
- ‚úÖ Repository decides whether to use remote or local data
- ‚úÖ Converts **Models** (data layer) ‚Üí **Entities** (domain layer)
- ‚úÖ Handles errors gracefully using **Either** from Dartz
- ‚úÖ Implements **offline-first** strategy with caching

---

### 3Ô∏è‚É£ Presentation Layer ‚Äî User Interface üé®

**Location:** `lib/features/books/presentation/`

This layer handles everything related to the UI:

#### üé≠ State Management (Cubit)
Manages UI state using **Cubit** from flutter_bloc:

```dart
class NewestBooksCubit extends Cubit<NewestBooksState> {
  final GetNewestBooksUseCase getNewestBooksUseCase;
  NewestBooksCubit({required this.getNewestBooksUseCase})
      : super(NewestBooksInitial());
  List<BookEntity> newestBooks = [];
  Future<void> getNewestBooks({int pageNumber = 0}) async {
    pageNumber == 0
        ? emit(NewestBooksLoading())
        : emit(NewestBooksPaginationLoading(newestBooks: newestBooks));
    final result = await getNewestBooksUseCase.call(pageNumber);
    result.fold(
        (failure) => pageNumber == 0
            ? emit(NewestBooksFailure(errorMessage: failure.message))
            : emit(NewestBooksPaginationFailure(
                errorMessage: failure.message,
                newestBooks: newestBooks,
              )), (books) {
      newestBooks = [...newestBooks, ...books];
      emit(NewestBooksSuccess(newestBooks: newestBooks));
    });
  }
}
```

#### üì± UI Widgets
Flutter widgets that display data and listen to state changes:

```dart
BlocBuilder<NewestBooksCubit, NewestBooksState>(
      builder: (context, state) {
        switch (state) {
          case NewestBooksInitial():
          case NewestBooksLoading():
            return const CircularProgressIndicator();
          case NewestBooksSuccess():
            return NewestBooksListView(books: state.newestBooks);
          case NewestBooksPaginationLoading():
            return NewestBooksListView(books: state.newestBooks);
          case NewestBooksPaginationFailure():
            return NewestBooksListView(books: state.newestBooks);
          case NewestBooksFailure():
            return Text(state.errorMessage);
        }
      },
    )
```

**Why Cubit?**
- ‚úÖ Simpler than full BLoC (no events needed)
- ‚úÖ Predictable state management
- ‚úÖ Easy to test
- ‚úÖ Works seamlessly with flutter_bloc

---

## üìÇ Project Structure

```
lib/
‚îÇ
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_constants.dart          # API endpoints and config
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_service.dart            # Dio service wrapper
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ error/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exceptions.dart             # Data layer exceptions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ failures.dart               # Domain layer failures
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ usecases/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usecase.dart                # Base UseCase abstract class
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ    ‚îú‚îÄ‚îÄ helpers/
‚îÇ   ‚îÇ    ‚îÇ   ‚îî‚îÄ‚îÄ hive_helper.dart        # Manages Hive boxes
‚îÇ   ‚îÇ    ‚îú‚îÄ‚îÄ app_router.dart             # GoRouter configuration
‚îÇ   ‚îÇ    ‚îú‚îÄ‚îÄ styles.dart                 # App theme and colors
‚îÇ   ‚îÇ    ‚îî‚îÄ‚îÄ assets.dart                 # Manages app asset paths
‚îÇ   ‚îÇ    
‚îÇ   ‚îî‚îÄ‚îÄ service_locator.dart             # Registers and provides app dependencies
‚îÇ
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îî‚îÄ‚îÄ books/
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ data/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ datasources/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ books_remote_data_source.dart
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ books_local_data_source.dart
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ book_model.dart
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ book_model.g.dart         # Hive adapter
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ repositories/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ books_repository_impl.dart
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ domain/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ entities/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ book_entity.dart
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ books_repository.dart     # Abstract interface
‚îÇ       ‚îÇ   ‚îÇ
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ usecases/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ get_featured_books_usecase.dart
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ get_newest_books_usecase.dart
‚îÇ       ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ presentation/
‚îÇ           ‚îú‚îÄ‚îÄ manager/
‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ featured_books_cubit/
‚îÇ           ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ featured_books_cubit.dart
‚îÇ           ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ featured_books_state.dart
‚îÇ           ‚îÇ   ‚îÇ
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ newest_books_cubit/
‚îÇ           ‚îÇ       ‚îú‚îÄ‚îÄ newest_books_cubit.dart
‚îÇ           ‚îÇ       ‚îî‚îÄ‚îÄ newest_books_state.dart
‚îÇ           ‚îÇ
‚îÇ           ‚îî‚îÄ‚îÄ views/
‚îÇ               ‚îú‚îÄ‚îÄ books_view.dart
‚îÇ               ‚îî‚îÄ‚îÄ widgets/
‚îÇ                   ‚îú‚îÄ‚îÄ books_view_body.dart
‚îÇ                   ‚îú‚îÄ‚îÄ featured_books_list.dart
‚îÇ                   ‚îú‚îÄ‚îÄ newest_books_list.dart
‚îÇ                   ‚îî‚îÄ‚îÄ book_card.dart
‚îÇ
‚îî‚îÄ‚îÄ main.dart                               # App entry point
‚îÇ
‚îî‚îÄ‚îÄ simple_bloc_observer.dart               # Logs BLoC events, transitions, and errors

```

---

## üîÑ Data Flow & Architecture Diagram
<div align="center">
  <img src="clean-architecture.jpg" width="600" alt="Diagram"/>
</div>


---

## ‚öôÔ∏è Dependency Injection with GetIt

All dependencies are registered centrally in `injection_container.dart` using **GetIt**:

```dart

final getIt = GetIt.instance;

void setupServiceLocator() {
  getIt.registerLazySingleton<ApiService>(() => ApiService());
  getIt.registerLazySingleton<BooksRemoteDataSource>(
    () => BooksRemoteDataSourceImpl(apiService: getIt<ApiService>()),
  );
  getIt.registerLazySingleton<BooksLocalDataSource>(
    () => const BooksLocalDataSourceImpl(),
  );
  getIt.registerLazySingleton<BooksRepository>(
    () => BooksRepositoryImpl(
      remoteDataSource: getIt<BooksRemoteDataSource>(),
      localDataSource: getIt<BooksLocalDataSource>(),
    ),
  );
  getIt.registerLazySingleton<GetFeaturedBooksUseCase>(
    () => GetFeaturedBooksUseCase(booksRepository: getIt<BooksRepository>()),
  );
  getIt.registerLazySingleton<GetNewestBooksUseCase>(
    () => GetNewestBooksUseCase(booksRepository: getIt<BooksRepository>()),
  );
  getIt.registerFactory<FeaturedBooksCubit>(
    () => FeaturedBooksCubit(
        getFeaturedBooksUseCase: getIt<GetFeaturedBooksUseCase>()),
  );
  getIt.registerFactory<NewestBooksCubit>(
    () =>
        NewestBooksCubit(getNewestBooksUseCase: getIt<GetNewestBooksUseCase>()),
  );
}

```

**Benefits:**
- ‚úÖ Centralized dependency management
- ‚úÖ Easy to swap implementations (e.g., mock for testing)
- ‚úÖ Lazy initialization for better performance
- ‚úÖ Clean and testable code

---

## üåê API Integration

### Google Books API

The app fetches data from the [Google Books API](https://developers.google.com/books):

**Endpoint:** `https://www.googleapis.com/books/v1/volumes`

**Example Request:**
```
GET /volumes?q=programming&filter=free-ebooks&maxResults=20&orderBy=newest
```

### API Service Layer

```dart
class ApiService {
  final Dio dio;

  Future<Response> getVolumes({
    required String query,
    String? filter,
    int? maxResults,
    String? orderBy,
    int? startIndex,
  }) async {
    return await dio.get(
      ApiConstants.volumes,
      queryParameters: {
        'q': query,
        if (filter != null) 'filter': filter,
        'maxResults': maxResults ?? 20,
        if (orderBy != null) 'orderBy': orderBy,
        if (startIndex != null) 'startIndex': startIndex,
      },
    );
  }
}
```

### Error Handling

The app uses **Either** from Dartz to handle errors functionally:

```dart
// Success case
return Right(books);

// Failure case
return Left(ServerFailure('Failed to fetch books'));
```

**Failure Types:**
- `ServerFailure` ‚Äî API errors (500, 404, etc.)
- `CacheFailure` ‚Äî Local storage errors
- `NetworkFailure` ‚Äî No internet connection

---

## üé® Features

- ‚úÖ **Featured Books Display** ‚Äî Shows curated programming books  
- ‚úÖ **Newest Books List** ‚Äî Displays recently published books  
- ‚úÖ **Pagination** ‚Äî Loads books gradually for better performance  
- ‚úÖ **Offline Support** ‚Äî Caches data locally with Hive  
- ‚úÖ **Error Handling** ‚Äî Graceful fallback to cached data  
- ‚úÖ **Clean UI** ‚Äî Modern, responsive design  
- ‚úÖ **State Management** ‚Äî Predictable state with Cubit  
- ‚úÖ **Dependency Injection** ‚Äî Scalable DI with GetIt  
- ‚úÖ **API Integration** ‚Äî Real data from Google Books API  


---

## üöÄ How to Run the Project



### Installation Steps

1. **Clone the repository**
```bash
git clone https://github.com/your-username/bookly-clean-architecture.git
cd bookly-clean-architecture
```

2. **Install dependencies**
```bash
flutter pub get
```

3. **Set up environment variables** (Optional)

Create a `.env` file in the root directory:
```env
GOOGLE_BOOKS_API_KEY=your_api_key_here
```

> **Note:** The Google Books API works without an API key for basic requests, but adding one increases your quota.

4. **Generate Hive adapters**
```bash
flutter pub run build_runner build --delete-conflicting-outputs
```

5. **Run the app**
```bash
flutter run
```

---

## üîÆ Future Improvements

- **Comprehensive Unit Tests** ‚Äî Ensure full coverage and maintain high code quality across all layers.  
- **CI/CD Pipeline** ‚Äî Automate testing, integration, and deployment for seamless delivery and faster iterations.

---




## üì∏ App Screens

<div align="center">
<img src="ui-app.jpg"/>
</div>

---

## üìñ Learning Resources

If you're learning Clean Architecture in Flutter, check out these resources:

- [The Clean Architecture - Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Flutter Clean Architecture - Reso Coder](https://resocoder.com/flutter-clean-architecture-tdd/)
- [BLoC Pattern Documentation](https://bloclibrary.dev/)
- [Dependency Injection in Flutter](https://pub.dev/packages/get_it)

---


## üë®‚Äçüíª Author

**Abdelazim Ramadan**

- **Email**: [eng.abdelazim3@gmail.com](eng.abdelazim3@gmail.com)  
- **LinkedIn**: [Abdelazim Ramadan](https://www.linkedin.com/in/azimramadan?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app)  
- **Facebook**: [ÿπÿ®ÿØÿßŸÑÿπÿ∏ŸäŸÖ ÿ±ŸÖÿ∂ÿßŸÜ](https://www.facebook.com/share/19pSykEJNM/?mibextid=qi2Omg)  


---

## üåü Show Your Support

If this project helped you understand Clean Architecture in Flutter, please give it a ‚≠ê!

---

<div align="center">

**Made with ‚ù§Ô∏è and Clean Architecture principles**



</div>
